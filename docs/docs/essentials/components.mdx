# Components

Components are a core concept in Leafjs. This article will walk through those core concepts about Leafjs components.

Each Leaf component is a valid [web-component](https://developer.mozilla.org/en-US/docs/Web/Web_Components), which is basicly a natively supported custom element.

## Defining a component

Every Leafjs component should inherit from the `LeafComponent` class. A basic component will be as follows:

```js
import {
  LeafComponent,
  registerComponent,
  HTMLElements,
} from 'https://cdn.jsdelivr.net/npm/@leaf-web/core@latest/dist/leaf.min.js';

class MyComponent extends LeafComponent {
  constructor() {
    super();
  }

  render() {
    return HTMLElements.h1('Component content');
  }
}

registerComponent('my-component', MyComponent);
```

:::note
It is required that you call `super()` inside the constructor of your component.
:::

### Render functions

Render functions define how a component should be rendered on the DOM. Leafjs comes with several native components exposed through the `HTMLElements` export, such as `h1`, `h2`, `p`, etc.

The below example demostrates how to use `HTMLElements` in your component.

```js
class MyComponent extends LeafComponent {
  constructor() {
    super();
  }

  // highlight-start
  render() {
    const heading = HTMLElements.h1('Heading 1', { style: 'color: red' });
    const container = HTMLElements.div([heading, HTMLElements.p('Some content...')]);
    return container;
  }
  // highlight-end
}
```

The first argument of `HTMLElements` accepts either an element or a list of element, representing the content of the element. The second argument is an optional attribute set, which will be set on the actual element later on in the HTMLElements constructor.

:::tip
If the element has no content, you can omit the first parameter and directly pass in the attributes:

```js
const input = HTMLElements.input({ value: 'Lorem ipsum' });
```
:::

### Registering a component

Each Leafjs component need to be registered before actual usage. To do that, Leaf provides a high level wrapper to register the custom components to the registery. See the example below.

```js
import {
  LeafComponent,
  registerComponent,
  HTMLElements,
} from 'https://cdn.jsdelivr.net/npm/@leaf-web/core@latest/dist/leaf.min.js';

class SomeComponent extends LeafComponent {
  // component content...
}

// register `SomeComponent` with name `component-name`
// highlight-next-line
registerComponent('component-name', SomeComponent);
```

This allows the usage of `component-name` element in HTML templates AND using `document.createElement`. Under the hood, Leafjs calls the custom component registery as follows:

```js
customElements.define(name, component);
```

:::note
The first parameter of `registerComponent`, or the component name, needs to contain **at least one** hyphen. More information on custom element name rules [here](https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name).
:::

## Using your component

After defining and registering your own custom Leaf component, you probably want to reuse it in other components. Custom components are pretty much the same as the basic HTML elements, which allows you to create a component instance using `MyComponent(...props)`. If you want to define a custom atom component with props to pass in, such as a custom `Button`, define your props in the constructor of your component:

```js
class Button extends LeafComponent {
  constructor(content, props) {
    super();

    // do something with the props passed in, such as storing them:
    this.content = content;
    this.props = props;
  }

  render() {
    // render your element using the props
    return HTMLElements.button(this.content, this.props);
  }
}
```

Yet this is still a **class**, not a function to invoke. In order to create your component using a function-style, instead of exporting your component export the following:

```js
export default registerComponent('my-button', Button);
```

The `registerComponent` will define your component in the registery and return a generated function which will later instantiate your component using the arguments passed to the function.

**DO NOT** define your properties in the render function. This will not work: render functions are all called internally by Leafjs renderer and is not controlled by the user.

## Advanced usage

### Creating advanced HTML elements

Sometimes you may want to create a HTML element that is not in Leafjs's pre-defined element list, such as `<details />`. You can use the provided function `createElement` which enhances the default `document.createElement` with automatic attribute assignment and children nodes defination.

```js
import {
  LeafComponent,
  registerComponent,
  HTMLElements,
  createElement
} from 'https://cdn.jsdelivr.net/npm/@leaf-web/core@latest/dist/leaf.min.js';

class Component extends LeafComponent {
  // ...

  render() {
    // ...
    // highlight-next-line
    const detailsElement = createElement('details', detailsContent, detailsProps);
  }
}
```

This allows you to create any elements just like using `document.createElement`.

### Using base components with `new` keyword

:::danger
By using class-based base components means you will [lose support of Safari](https://lists.w3.org/Archives/Public/public-webapps/2013OctDec/1051.html).

Although the class-style and function-style might look the same, but under the hood Leafjs implement them in different methods.

For function-style creation, Leafjs simply calls `createElement` which then calls `document.createElement` to create an element, which is supported by 100% modern browsers.

However, for class-style, Leafjs extends the default `HTMLXXXElement` class, for example:

```js
class LeafInput extends HTMLInputElement {
  // ...
}

customElements.define('leaf-input', LeafInput, { extends: 'input' })
```

And extending builtin elements is [**not and will not** be supported by Safari](https://stackoverflow.com/a/72090672/13266491).

**We strongly recommend using function-style declaration unless for really complex use cases.**
:::

If you want a class-style component / element creation, Leafjs fully supports it! By using `HTMLClassElements` provided by Leafjs, you can use `new HTMLClassElements.element(...props)` to create an instance of the element.

For example:

```js
import {
  LeafComponent,
  registerComponent,
  HTMLClassElements,
  createElement
} from 'https://cdn.jsdelivr.net/npm/@leaf-web/core@latest/dist/leaf.min.js';

class Component extends LeafComponent {
  // ...

  render() {
    // ...
    // highlight-next-line
    const element = new HTMLClassElements.p('Hello!');
  }
}
```

And in this case, you might want to use your own custom components in class-style too. Simply export the original component instead of function generated by `registerComponent()`. However, you still need to call `registerComponent` to register component to the registery.
