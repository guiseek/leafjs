"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(){this.activeEffects=[],this.targetMap=new WeakMap,this.onChange=null,this.isSetting=!1,this.actualState=void 0}var e=t.prototype;return e.getTrackableObject=function(t,e){for(var n in t)t[n]&&"object"==typeof t[n]&&(t[n]=this.getTrackableObject(t[n],e));var r=this,i=new Proxy(t,{get:function(t,n,r){var i=Reflect.get(t,n,r);return e.onGet(t,n,r),i},set:function(t,n,i,a){"object"==typeof i&&(i=r.getTrackableObject(i,e));var c=Reflect.set(t,n,i,a);return e.onSet(t,n,i,a),c},deleteProperty:function(t,n){var r=Reflect.deleteProperty(t,n);return e.onDeleteProperty(t,n),r}});return Array.isArray(t)&&Object.setPrototypeOf(i,Array.prototype),i},e.track=function(t,e){if(this.activeEffects.length){var n=this.targetMap.get(t);n||(n=new Map,this.targetMap.set(t,n));var r=n.get(e);r||(r=new Set,n.set(e,r)),this.activeEffects.forEach((function(t){return null==r?void 0:r.add(t)}))}},e.trigger=function(t,e){var n=this.targetMap.get(t);if(n){var r=n.get(e);r&&r.forEach((function(t){t()}))}},e.watchEffect=function(t){this.activeEffects.push(t),t(),this.activeEffects.pop()},e.build=function(t){var e=this,n=this,r=function t(){e.isSetting?setTimeout(t,2):e.onChange&&e.onChange()};return this.actualState=this.getTrackableObject(t,{onGet:function(t,e){n.track(t,e)},onSet:function(t,e){n.isSetting||(n.isSetting=!0,r()),n.trigger(t,e),n.isSetting=!1},onDeleteProperty:function(){}}),this.actualState},e.ref=function(t){var e=this,n={get value(){return e.track(n,"value"),t},set value(r){r!==t&&(t=r,e.trigger(n,"value"))}};return n},e.computed=function(t){var e=this.ref(null);return this.watchEffect((function(){return e.value=t()})),e},e.onStateChange=function(t){this.onChange=t,t()},t}();exports.Reactive=t;
//# sourceMappingURL=reactivity.min.js.map
