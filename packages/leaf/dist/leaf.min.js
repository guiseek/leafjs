"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function i(e,t,n){return i=o()?Reflect.construct.bind():function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&r(i,n.prototype),i},i.apply(null,arguments)}function a(e){var t="function"==typeof Map?new Map:void 0;return a=function(e){if(null===e||(o=e,-1===Function.toString.call(o).indexOf("[native code]")))return e;var o;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return i(e,arguments,n(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),r(a,e)},a(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function l(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}Object.defineProperty(exports,"__esModule",{value:!0});var p={};Object.defineProperty(p,"__esModule",{value:!0});var d,h,v,m,y,g,b,E,w=function(){function e(){this.activeEffects=[],this.targetMap=new WeakMap,this.onChange=null,this.isSetting=!1,this.actualState=void 0}var t=e.prototype;return t.getTrackableObject=function(e,t){for(var n in e)e[n]&&"object"==typeof e[n]&&(e[n]=this.getTrackableObject(e[n],t));var r=this,o=new Proxy(e,{get:function(e,n,r){var o=Reflect.get(e,n,r);return t.onGet(e,n,r),o},set:function(e,n,o,i){"object"==typeof o&&(o=r.getTrackableObject(o,t));var a=Reflect.set(e,n,o,i);return t.onSet(e,n,o,i),a},deleteProperty:function(e,n){var r=Reflect.deleteProperty(e,n);return t.onDeleteProperty(e,n),r}});return Array.isArray(e)&&Object.setPrototypeOf(o,Array.prototype),o},t.track=function(e,t){if(this.activeEffects.length){var n=this.targetMap.get(e);n||(n=new Map,this.targetMap.set(e,n));var r=n.get(t);r||(r=new Set,n.set(t,r)),this.activeEffects.forEach((function(e){return null==r?void 0:r.add(e)}))}},t.trigger=function(e,t){var n=this.targetMap.get(e);if(n){var r=n.get(t);r&&r.forEach((function(e){e()}))}},t.watchEffect=function(e){this.activeEffects.push(e),e(),this.activeEffects.pop()},t.build=function(e){var t=this,n=this,r=function e(){t.isSetting?setTimeout(e,2):t.onChange&&t.onChange()};return this.actualState=this.getTrackableObject(e,{onGet:function(e,t){n.track(e,t)},onSet:function(e,t){n.isSetting||(n.isSetting=!0,r()),n.trigger(e,t),n.isSetting=!1},onDeleteProperty:function(){}}),this.actualState},t.ref=function(e){var t=this,n={get value(){return t.track(n,"value"),e},set value(r){r!==e&&(e=r,t.trigger(n,"value"))}};return n},t.computed=function(e){var t=this.ref(null);return this.watchEffect((function(){return t.value=e()})),t},t.onStateChange=function(e){this.onChange=e,e()},e}(),x=p.Reactive=w,M=new WeakMap,L=function(e){return HTMLCollection.prototype.isPrototypeOf(e)||NodeList.prototype.isPrototypeOf(e)||Array.isArray(e)},T=function(e){return void 0!==e.nodeType||"string"==typeof e||"number"==typeof e},A={className:"class"},C=function(e){return!1===e||null==e},O=function e(t,n){if(L(n))for(var r,o=f(n);!(r=o()).done;){var i=r.value;C(i)||(Array.isArray(i)?e(t,i):t.append(i))}else t.append(n)},S=[{name:"button",extends:HTMLButtonElement},{name:"div",extends:HTMLDivElement},{name:"input",extends:HTMLInputElement},{name:"h1",extends:HTMLHeadingElement},{name:"h2",extends:HTMLHeadingElement},{name:"h3",extends:HTMLHeadingElement},{name:"h4",extends:HTMLHeadingElement},{name:"h5",extends:HTMLHeadingElement},{name:"h6",extends:HTMLHeadingElement},{name:"p",extends:HTMLParagraphElement},{name:"li",extends:HTMLLIElement},{name:"ul",extends:HTMLUListElement},{name:"ol",extends:HTMLOListElement},{name:"span",extends:HTMLSpanElement},{name:"form",extends:HTMLFormElement},{name:"label",extends:HTMLLabelElement},{name:"a",extends:HTMLAnchorElement},{name:"textarea",extends:HTMLTextAreaElement},{name:"iframe",extends:HTMLIFrameElement},{name:"img",extends:HTMLImageElement},{name:"video",extends:HTMLVideoElement}],H={},P={};S.forEach((function(e){P[e.name]=function(t,n){return F(e.name,t,n)},H[e.name]=function(e){function n(t,n){var r;if(r=e.call(this)||this,!t)return s(r);if(!T(t)&&!L(t)){for(var o in t)r.setAttribute(o in A?A[o]:o,t[o]);return s(r)}if(O(s(r),[].concat(t)),!n)return s(r);for(var i in n)r.setAttribute(i in A?A[i]:i,n[i]);return r}return t(n,e),n}(e.extends),customElements.define("leaf-__"+e.name,H[e.name],{extends:e.name})}));var k=new WeakMap,j=[{name:"value",attr:"value"}],R=new Map,N=function(e,t){return e.startsWith("on")},_=function(e){return e.nodeType===Node.ELEMENT_NODE},U=function(e){return!0===e.isLeafComponent},W=function(e){return e.nodeType===Node.TEXT_NODE},I=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e},D=function(e,t,n){if("string"!=typeof e){var r=M.get(e);if(!r)throw new Error("Unable to fetch component from registery.");e=r}var o=document.createElement(e),i=new Set;for(var a in t){var s=t[a];if(N(a)){var u=a.substring(2).toLowerCase();i.add({name:u,handler:s}),o.addEventListener(u,s)}else U(o)&&(o.props[a]=s,!I(s))||(a in A?o.setAttribute(A[a],s):o.setAttribute(a,s))}return k.set(o,i),n&&O(o,n),o},F=function(e,t,n){return void 0===t?D(e):T(t)||L(t)?D(e,n,t):D(e,t)},B=function(e){if(k.has(e))return k.get(e)},$=function(e,t){k.set(e,t||new Set)},G=function(e){return k.delete(e)},V=function(e,t){e.forEach((function(e){t.appendChild(e)}))},X=function e(t,n,r,o){if(r){var i=t.length,a=n.length;if(_(r)&&_(o)){var s=B(r),u=B(o);null==s||s.forEach((function(e){r.removeEventListener(e.name,e.handler)})),null==u||u.forEach((function(e){r.addEventListener(e.name,e.handler)})),$(r,u),G(o)}for(var c=0,l=0;Math.max(c,l)<Math.min(i,a);c++,l++){var p=t[c],d=n[l];if(_(p)&&p.hasAttribute("leaf-preserve")&&(p=t[++c],i--),U(p)&&(p.isUpdating=!0),U(d)&&(d.isUpdating=!0),_(p)&&_(d)){for(var h,v=Array.prototype.slice.call(p.attributes),m=f(Array.prototype.slice.call(d.attributes));!(h=m()).done;){var y=h.value;if(I(y.value)&&p.getAttribute(y.name)!==y.value){p.setAttribute(y.name,y.value);for(var g,b=f(j);!(g=b()).done;){var E=g.value;E.name===y.name&&(p[E.name]=y.value)}}}for(var w,x=f(v);!(w=x()).done;){var M=w.value;d.hasAttribute(M.name)||p.removeAttribute(M.name)}}if(_(p)&&_(d)&&p.tagName!==d.tagName){var L=p.previousSibling;if(p.outerHTML=p.outerHTML.replace(new RegExp("<"+p.tagName.toLowerCase()+"(.*?)","g"),"<"+d.tagName.toLowerCase()+"$1").replace(new RegExp("</"+p.tagName.toLowerCase()+"(.*?)","g"),"</"+d.tagName.toLowerCase()+"$1"),p=L?L.nextSibling:r.firstChild,!_(p))continue;U(p)&&(p.isUpdating=!0)}if(U(p)&&U(d)){for(var T,A=f(d.attributes);!(T=A()).done;){var C=T.value;p.props[C.name]=C.value}for(var O in d.props)p.props[O]=d.props[O];for(var S in p.props)S in d.props||d.hasAttribute(S)||delete p.props[S]}if(W(p)&&W(d)){if(p.textContent===d.textContent)continue;r.replaceChild(d,p)}else W(p)&&_(d)&&(r.replaceChild(d,p),U(p=d)&&(p.isUpdating=!0)),_(p)&&W(d)?r.replaceChild(d,p):(e(Array.from(p.childNodes),Array.from(d.childNodes),p,d),U(p)&&(p.isUpdating=!1,p.rerender()))}a>i?n.slice(i).forEach((function(e){e.nodeType!==Node.TEXT_NODE?V([e],r):r.appendChild(e)})):a<i&&t.slice(a).forEach((function(e){r.removeChild(e)}))}},q=function(n){function r(e){var t;t=n.call(this)||this,d.add(s(t)),h.set(s(t),null),v.set(s(t),null),m.set(s(t),null),y.set(s(t),null),g.set(s(t),void 0),b.set(s(t),!1),t.isLeafComponent=!0,t.isUpdating=!1;for(var r,o={},i=f(t.constructor.observedAttributes);!(r=i()).done;){o[r.value]=null}var a=s(t),u=function(e){if(!t.constructor.observedAttributes.includes(e))throw new Error("Unknown property "+e+". Expected one of "+t.constructor.observedAttributes.map((function(e){return"'"+e+"'"})).join(", ")+".")};return t.props=new Proxy(o,{get:function(e,t,n){return u(t),Reflect.get(e,t,n)},set:function(e,t,n,r){u(t),I(n)&&a.setAttribute(t,n.toString());var o=Reflect.set(e,t,n,r);return c(a,b,"f")&&a.rerender(),o},has:function(e,t){return a.constructor.observedAttributes.includes(t)},deleteProperty:function(e,t){return u(t),Reflect.deleteProperty(e,t)}}),t}t(r,n);var o,i,a,u=r.prototype;return u.fireEvent=function(e,t){if(e instanceof Event)return e.stopPropagation(),this.fireEvent(e.type,t);var n=new CustomEvent(e,{detail:t});return this.dispatchEvent(n)},u.rerender=function(){var e;if(c(this,y,"f")&&!this.isUpdating&&c(this,b,"f")&&!(null===(e=c(this,v,"f"))||void 0===e?void 0:e.isSetting)){c(this,v,"f")&&(c(this,v,"f").isSetting=!0),c(this,m,"f")?this.onRerender():this.onMounted();var t=this.render();if(Array.isArray(t)||(t=[t]),c(this,v,"f")&&(c(this,v,"f").isSetting=!1),!c(this,m,"f"))return V(t,c(this,y,"f")),void l(this,m,t,"f");X(Array.from(c(this,y,"f").childNodes),Array.from(t),c(this,y,"f"),t[0]),l(this,m,t,"f")}},u.onMounted=function(){},u.onRerender=function(){},u.connectedCallback=function(){var e,t,n,r,o,i=this;l(this,b,!0,"f"),l(this,y,this.attachShadow({mode:"closed"}),"f");var a=F("style"),s=null!==(e=this.css)&&void 0!==e?e:c(this,d,"m",E);a.textContent=s(),a.setAttribute("leaf-preserve","true"),c(this,y,"f").appendChild(a);var u=R.get(c(this,g,"f")||"");l(this,v,u||new x,"f"),(null===(t=c(this,v,"f"))||void 0===t?void 0:t.actualState)?l(this,h,c(this,v,"f").actualState,"f"):l(this,h,null===(n=c(this,v,"f"))||void 0===n?void 0:n.build(null!==(r=c(this,h,"f"))&&void 0!==r?r:{}),"f"),c(this,v,"f")&&c(this,g,"f")&&R.set(c(this,g,"f"),c(this,v,"f")),null===(o=c(this,v,"f"))||void 0===o||o.onStateChange((function(){return i.rerender()}))},u.attributeChangedCallback=function(e,t,n){t!==n&&("key"===e&&l(this,g,n,"f"),this.rerender())},u.render=function(){throw new Error("Render function of `LeafComponent` must be overrided.")},u.css=function(){return""},o=r,a=[{key:"watchedProps",get:function(){return[]}},{key:"observedAttributes",get:function(){return[].concat(this.watchedProps,["key"])}}],(i=[{key:"state",get:function(){if(c(this,b,"f"))return c(this,h,"f")},set:function(e){l(this,h,e,"f")}},{key:"listeners",get:function(){return Array.from(B(this)||[])}}])&&e(o.prototype,i),a&&e(o,a),Object.defineProperty(o,"prototype",{writable:!1}),r}(a(HTMLElement));h=new WeakMap,v=new WeakMap,m=new WeakMap,y=new WeakMap,g=new WeakMap,b=new WeakMap,d=new WeakSet,E=function(){return""},exports.HTMLClassElements=H,exports.HTMLElements=P,exports.LeafComponent=q,exports.Reactive=x,exports.createElement=F,exports.createElementReactStyle=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return r?F(e,r,null!=t?t:{}):F(e,null!=t?t:{})},exports.deleteEventListenerOf=G,exports.directPropUpdate=j,exports.eventListeners=k,exports.getEventListenerOf=B,exports.isElement=_,exports.isEventListener=N,exports.isValidAttribute=I,exports.mountElements=V,exports.patchElements=X,exports.reactiveInstances=R,exports.registerComponent=function(e,t,n){return customElements.define(e,t,n),M.set(t,e),function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return i(t,[e].concat(r))}},exports.runCallbackOnElements=function e(t,n){if(L(t))for(var r,o=f(t);!(r=o()).done;){var i=r.value;Array.isArray(i)?e(i,n):n(i)}else n(t)},exports.setEventListenerOf=$;
//# sourceMappingURL=leaf.min.js.map
