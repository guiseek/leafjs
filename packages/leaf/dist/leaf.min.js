"use strict";function e(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function t(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n}Object.defineProperty(exports,"__esModule",{value:!0});var n={};Object.defineProperty(n,"__esModule",{value:!0});var r=n.Reactive=class{constructor(){this.activeEffects=[],this.targetMap=new WeakMap,this.onChange=null}getTrackableObject(e,t){for(const n in e)"object"==typeof e[n]&&(e[n]=this.getTrackableObject(e[n],t));const n=this,r=new Proxy(e,{get(e,n,r){const s=Reflect.get(e,n,r);return t.onGet(e,n,r),s},set(e,r,s,a){"object"==typeof s&&(s=n.getTrackableObject(s,t));const o=Reflect.set(e,r,s,a);return t.onSet(e,r,s,a),n.onChange&&n.onChange(),o},deleteProperty(e,n){const r=Reflect.deleteProperty(e,n);return t.onDeleteProperty(e,n),r}});return Array.isArray(e)&&Object.setPrototypeOf(r,Array.prototype),r}track(e,t){if(!this.activeEffects.length)return;let n=this.targetMap.get(e);n||(n=new Map,this.targetMap.set(e,n));let r=n.get(t);r||(r=new Set,n.set(t,r)),this.activeEffects.forEach((e=>null==r?void 0:r.add(e)))}trigger(e,t){const n=this.targetMap.get(e);if(!n)return;const r=n.get(t);r&&r.forEach((e=>{e()}))}watchEffect(e){this.activeEffects.push(e),e(),this.activeEffects.pop()}build(e){const t=this;return this.getTrackableObject(e,{onGet(e,n){t.track(e,n)},onSet(e,n){t.trigger(e,n)},onDeleteProperty(){}})}ref(e){const t=this,n={get value(){return t.track(n,"value"),e},set value(r){r!==e&&(e=r,t.trigger(n,"value"))}};return n}computed(e){const t=this.ref(null);return this.watchEffect((()=>t.value=e())),t}onStateChange(e){this.onChange=e,e()}};const s=e=>HTMLCollection.prototype.isPrototypeOf(e)||NodeList.prototype.isPrototypeOf(e)||Array.isArray(e),a=e=>void 0!==e.nodeType||"string"==typeof e||"number"==typeof e,o=(e,t,n)=>(customElements.define(e,t,n),(...e)=>new t(...e)),i={className:"class"},l=(e,t)=>{if(s(t)){t=[...t].filter((e=>e));for(const n of t)Array.isArray(n)?l(e,n):e.append(n)}else e.append(t)},c=[{name:"button",extends:HTMLButtonElement},{name:"div",extends:HTMLDivElement},{name:"input",extends:HTMLInputElement},{name:"h1",extends:HTMLHeadingElement},{name:"h2",extends:HTMLHeadingElement},{name:"h3",extends:HTMLHeadingElement},{name:"h4",extends:HTMLHeadingElement},{name:"h5",extends:HTMLHeadingElement},{name:"h6",extends:HTMLHeadingElement},{name:"p",extends:HTMLParagraphElement},{name:"li",extends:HTMLLIElement},{name:"ul",extends:HTMLUListElement},{name:"ol",extends:HTMLOListElement},{name:"span",extends:HTMLSpanElement},{name:"form",extends:HTMLFormElement},{name:"label",extends:HTMLLabelElement},{name:"a",extends:HTMLAnchorElement},{name:"textarea",extends:HTMLTextAreaElement},{name:"iframe",extends:HTMLIFrameElement},{name:"img",extends:HTMLImageElement},{name:"video",extends:HTMLVideoElement}],d={},m={},f=e=>class extends e{constructor(e,t){if(super(),e)if(a(e)||s(e)){if(l(this,[...e]),t)for(const e in t)this.setAttribute(e in i?i[e]:e,t[e])}else for(const t in e)this.setAttribute(t in i?i[t]:t,e[t])}};var h,u,p,E;c.forEach((e=>{m[e.name]=(t,n)=>x(e.name,t,n),d[e.name]=f(e.extends),o(`leaf-__${e.name}`,d[e.name],{extends:e.name})}));const g=(e,t,n)=>{const r=document.createElement(e);for(const e in t)e.startsWith("on")?r.addEventListener(e.substring(2).toLowerCase(),t[e]):r.setAttribute(e,t[e]);return n&&l(r,n),r},x=(e,t,n)=>void 0===t?g(e):a(t)||s(t)?g(e,n,t):g(e,t),v=(e,t)=>{if(s(e))for(const n of e)Array.isArray(n)?v(n,t):t(n);else t(e)};class y extends HTMLElement{constructor(){super(),h.add(this),u.set(this,null),p.set(this,null)}get state(){return e(this,u,"f")}set state(n){if(!e(this,u,"f"))return t(this,p,new r,"f"),void t(this,u,e(this,p,"f").build(n),"f");t(this,u,n,"f")}connectedCallback(){var t,n;const r=this.attachShadow({mode:"closed"});let s=null;const a=x("style"),o=null!==(t=this.css)&&void 0!==t?t:e(this,h,"m",E);a.textContent=o(),r.appendChild(a);const i=()=>{s&&v(s,(e=>r.removeChild(e))),s=this.render(),v(s,(e=>r.appendChild(e)))};e(this,p,"f")?null===(n=e(this,p,"f"))||void 0===n||n.onStateChange(i):i()}render(){return this}css(){return""}}u=new WeakMap,p=new WeakMap,h=new WeakSet,E=function(){return""},exports.HTMLClassElements=d,exports.HTMLElements=m,exports.LeafComponent=y,exports.Reactive=r,exports.createElement=x,exports.createElementReactStyle=(e,t,n)=>n?x(e,n,null!=t?t:{}):x(e,null!=t?t:{}),exports.registerComponent=o,exports.runCallbackOnElements=v;
//# sourceMappingURL=leaf.min.js.map
