{"version":3,"file":"index.js","sources":["../../../../../../../reactivity/dist/es/index.js"],"sourcesContent":["/** Reactive object. */\nclass Reactive {\n  constructor() {\n    /** Currently active running effects. */\n    this.activeEffects = [];\n    this.onChange = null;\n    this.isSetting = false;\n    this.actualState = undefined;\n  }\n  /**\n   * Get a trackable proxy object and fire certain callbacks on certain events.\n   * @param obj The object to track updates.\n   * @param callbacks Callbacks to run when certain event was fired.\n   * @returns A proxy to the original object.\n   */\n\n\n  getTrackableObject(obj, callbacks) {\n    for (const key in obj) {\n      if (obj[key] && typeof obj[key] === 'object') {\n        obj[key] = this.getTrackableObject(obj[key], callbacks);\n      }\n    }\n\n    const outerThis = this;\n    const proxy = new Proxy(obj, {\n      get(target, key, receiver) {\n        const result = Reflect.get(target, key, receiver);\n        callbacks.onGet(target, key, receiver);\n        return result;\n      },\n\n      set(target, key, value, receiver) {\n        if (typeof value === 'object') {\n          value = outerThis.getTrackableObject(value, callbacks);\n        }\n\n        const result = Reflect.set(target, key, value, receiver);\n        callbacks.onSet(target, key, value, receiver);\n        return result;\n      },\n\n      deleteProperty(target, key) {\n        const result = Reflect.deleteProperty(target, key);\n        callbacks.onDeleteProperty(target, key);\n        return result;\n      }\n\n    });\n\n    if (Array.isArray(obj)) {\n      Object.setPrototypeOf(proxy, Array.prototype);\n    }\n\n    return proxy;\n  }\n  /**\n   * Create a reactive object and enable two-way auto update.\n   * @param target The object to be made reactive.\n   * @returns The proxied reactive object.\n   */\n\n\n  build(target) {\n    const outerThis = this; // workaround for to many rerenders\n    // check if it is currently setting a reactive property, watch until it finished setting\n    // and then invoke the `onStateChange` handler\n\n    const fireWhenUpdated = () => {\n      if (!this.isSetting) {\n        if (this.onChange) this.onChange();\n      } else {\n        setTimeout(fireWhenUpdated, 2);\n      }\n    };\n\n    this.actualState = this.getTrackableObject(target, {\n      onGet() {},\n\n      onSet() {\n        if (!outerThis.isSetting) {\n          outerThis.isSetting = true;\n          fireWhenUpdated();\n        }\n\n        outerThis.isSetting = false;\n      },\n\n      onDeleteProperty() {}\n\n    });\n    return this.actualState;\n  }\n  /**\n   * Fire an effect when any state changes, regardless of dependencies. This function can only be called once.\n   * @param effect Effect to run when state changes.\n   */\n\n\n  onStateChange(effect) {\n    this.onChange = effect;\n    effect();\n  }\n\n}\n\nexport { Reactive };\n//# sourceMappingURL=index.js.map\n"],"names":["Reactive","constructor","activeEffects","onChange","isSetting","actualState","undefined","getTrackableObject","obj","callbacks","key","outerThis","proxy","Proxy","get","target","receiver","result","Reflect","onGet","set","value","onSet","deleteProperty","onDeleteProperty","Array","isArray","Object","setPrototypeOf","prototype","build","fireWhenUpdated","setTimeout","onStateChange","effect"],"mappings":"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"}